#!/anaconda3/bin/python3

# Python Standard Library
import argparse
from os import path, system

# Other dependencies
import pandas as pd

BASE_URL = 'http://10.10.128.89:8080'

# BASE_URL = 'http://10.10.128.91:8080'
WAVES_DIR = '/opt/rtsystem/wfs'

DB_MSEED_FILE_FMT = 'i4.{station}.{channel}.{year}{julday:03d}_0+'

DB_MSEED_PATH_FMT = (f'{WAVES_DIR}/'
                     '{year}/{julday:03d}/'
                     f'{DB_MSEED_FILE_FMT}')


parser = argparse.ArgumentParser()
parser.add_argument('year', help='Year')
parser.add_argument('julday', help='julian day', type=int)
parser.add_argument('stations', help='Path to stations csv file')
parser.add_argument('output', help='Output directory')
args = parser.parse_args()


df = pd.read_csv(args.stations)

for i, row in df.iterrows():
    filepath = DB_MSEED_PATH_FMT.format(
        station=row.station,
        channel=row.channel,
        year=args.year,
        julday=args.julday
    )

    system(f'scp vulca:{filepath} "{args.output}/./"')


